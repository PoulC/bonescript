<html>
<head>
<title>Beaglebone + BeBoPr cape</title>
<style type="text/css" media="all">@import "/style.css";</style>
<link type="text/css" href="css/smoothness/jquery-ui-1.8.20.custom.css" rel="stylesheet" />
<script src="js/jquery-1.7.2.min.js"></script>
<script src="js/jquery-ui-1.8.20.custom.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
	<style type="text/css">
		/*demo page css*/
		body{ font: 62.5% "Trebuchet MS", sans-serif; margin: 50px;}
	</style>
</head>
<body>
<h1>Beaglebone + BeBoPr cape</h1>
<canvas id="ain2Canvas">2</canvas>
<canvas id="ain4Canvas">4</canvas>
<canvas id="ain6Canvas">6</canvas>

<div id = "ain2temp">0</div><br/>
<div id = "ain4temp">0</div><br/>
<div id = "ain6temp">0</div><br/>


<div>
    PWM0 duty cycle %
    <div id="pwm0Slider"></div>
</div><br>
<div>
    PWM1 duty cycle %
    <div id="pwm1Slider"></div>
</div><br>
<div>
    PWM2 duty cycle %
    <div id="pwm2Slider"></div>
</div><br>

<h2>Status:</h2>
<p><span id="status">Not yet connected</span></p>


<script src="/socket.io/socket.io.js"></script>
<script src="js/processing-1.3.6.min.js"></script>
<script type="text/javascript">
var socket = new io.connect();
socket.on('connect', function() {
    document.getElementById("status").innerHTML="Connected";
});

ain2Temp = 0;
ain4Temp = 0;
ain6Temp = 0;

socket.on('ain', function(data) {
    ain2Temp = data[2];
    ain4Temp = data[4];
    ain6Temp = data[6];
    document.getElementById("ain2temp").innerHTML=ain2Temp + "&#8451";
    document.getElementById("ain4temp").innerHTML=ain4Temp + "&#8451";
    document.getElementById("ain6temp").innerHTML=ain6Temp + "&#8451";
    setTimeout(function() {socket.emit('getTemp', 1);}, 1000);
});

socket.on('PWM', function(data) {
    pwm0dutypercent = data[0];
    pwm1dutypercent = data[1];
    pwm2dutypercent  = data[2];
    
    $('#pwm0Slider').slider( "option", "value", pwm0dutypercent );
    $('#pwm1Slider').slider( "option", "value", pwm1dutypercent );
    $('#pwm2Slider').slider( "option", "value", pwm2dutypercent );
    setTimeout(function() {socket.emit('getPWM', 1);}, 5000);
});

socket.emit('getTemp', 1);
socket.emit('getPWM', 1);

$(function() {
    $('#pwm0Slider').slider({ min: 0, max: 100, step: 1, animate: true,
        change: function(event, ui) {  socket.emit('pwmdutypercent', [ 0, ui.value ]); }
    });
    $('#pwm1Slider').slider({ min: 0, max: 100, step: 1, animate: true,
        change: function(event, ui) { socket.emit('pwmdutypercent', [ 1, ui.value ]); }
    });
    $('#pwm2Slider').slider({ min: 0, max: 100, step: 1, animate: true,
        change: function(event, ui) { socket.emit('pwmdutypercent', [ 2, ui.value ]); }
    });
});
</script>

</body>
</html>
