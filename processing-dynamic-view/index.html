<html>
<head>
<title>Beaglebone + BMP085 sensorboard Processing.js + socket.io demo</title>
<style type="text/css" media="all">@import "/style.css";</style>
<link rel="stylesheet" href="animate-style.css" />
<link rel="stylesheet" href="animate.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
</head>
<body>
<h1>Beaglebone + BMP085 sensorboard Processing.js + socket.io demo</h1>
<div id="animateTest"><canvas id="canvas1"></canvas></div>

<h2>Status:</h2>
<p><span id="status">Not yet connected</span></p>


<script src="/socket.io/socket.io.js"></script>
<script src="processing.js"></script>
<script type="text/javascript">
// global vars
var PI = 3.14;
var HALF_PI = 1.57;
var TWO_PI = 6.28;

// set defaults
var pressure = 950;
var temp = -10;
var punit = "jiggoWatt";
var tunit = "jiggoWatt";

var sketchProc = function(p) {
 p.size(600, 400);
 p.draw = function() {
  p.background(255,0);
  
  // barometer
  p.fill(220);
  p.noStroke();
  // Angles for sin() and cos() start at 3 o'clock;
  // subtract HALF_PI to make them start at the top
  p.ellipse(200, 200, 320, 320);
  
   var angle = -HALF_PI + HALF_PI / 3;
   var inc = TWO_PI / 12;
   p.stroke(0);
   p.strokeWeight(6);
   p.arc(200, 200, 320, 320, -(4/3)*PI, PI/3);

   // we want a range from ±950 - ±1050 milibar
   // 1-5=1010-1050, 7-12=950-1000
   p.textSize(15);
   for ( i = 1; i <= 12; i++, angle += inc ) {
       if(i!=6) {
         p.line(200 + Math.cos(angle) * 140,200 + Math.sin(angle) * 140,200 + Math.cos(angle) * 160,200 + Math.sin(angle) * 160);
         if (i < 6) {
           myText = 1000 + 10*i;
         } else {
           myText = 880 + 10*i;
         }     
         myWidth = p.textWidth(myText);
         p.fill(0, 102, 153);
         p.text(myText, 200 + Math.cos(angle) * 120 - myWidth/2,200 + Math.sin(angle) * 120);
       } else {
         myText = punit;  
         myWidth = p.textWidth(myText);
         p.fill(0, 102, 153);
         p.text(myText, 200 + Math.cos(angle) * 120 - myWidth/2,200 + Math.sin(angle) * 120);
       }
   }
  
  p.stroke(60);
  p.strokeWeight(6);
  p.line(200, 200, Math.cos(pressure) * 140 + 200, Math.sin(pressure) * 140 + 200);
  
  // thermometer
  // contour
  p.stroke(0);
  p.strokeWeight(60);
  p.line(500,350,500,50);
  p.ellipse(500, 350, 40, 40);
  
  p.strokeWeight(44);
  p.stroke(255);
  p.line(500,350,500,50);
  // mercury bubble
  if(temp > 0) {
    p.stroke(255,0,0);
  } else {
    p.stroke(0,0,255)
  }  
  p.ellipse(500, 350, 40, 40);
  // temperature line
  if (temp < 44) {
    p.strokeCap("butt");
  } else {
    // don't exceed thermometer bounds.  
    temp = 44;  
    p.strokeCap("round");  
  }      
  p.line(500,350,500,220 - 4 * temp);
  // scale
  p.strokeCap("round");
  p.stroke(0);
  p.strokeWeight(6);
  var theight = 300;
  var inc = 40;
  
  p.textSize(12);
  
  for ( i = 1; i <= 7; i++, theight -= inc ) {
    // longer bar at zero degrees C  
    if(i==3) {
        extra = 10;
    } else {
        extra = 0;
    }    
    p.line(475,theight,485 + extra, theight );
    
    myText = -30 + i*10;
    p.fill(0, 0, 0);
    p.text(myText, 492 + extra, theight + 4);
  }
  myText = temp + tunit;
  myWidth = p.textWidth(myText);
  p.fill(0, 0, 0);
  p.textSize(18);
  p.text(myText, 500 - myWidth/2, 350 + 9);
 };

 p.noLoop();
}

var canvas = document.getElementById("canvas1");
var processing = new Processing(canvas, sketchProc);

var socket = new io.connect();
socket.on('connect', function() {
 document.getElementById("status").innerHTML="Connected";
});

socket.on('pressuredata', function(data) {
 var myData = parseFloat(data);
 // Angles for sin() and cos() start at 3 o'clock;
 // subtract HALF_PI to make them start at the top
 // 30miliBar = HALF_PI
 pressure = (myData  - 1000) * (TWO_PI / 120) - HALF_PI;

 processing.redraw();
});

socket.on('tempdata', function(data) {
 var myData = parseFloat(data);
 // Angles for sin() and cos() start at 3 o'clock;
 // subtract HALF_PI to make them start at the top
 temp = myData;
 
 processing.redraw();
});

socket.on('pressureconfig', function(config) {
 try {
  punit = config.unit;
 } catch(ex) {}
});

socket.on('tempconfig', function(config) {
 try {
  tunit = config.unit;
 } catch(ex) {}
});

socket.on('disconnect', function() {
 document.getElementById("status").innerHTML="Disconnected";
 p.exit();
});

</script>

    		<hr>
			<h3>Attention seekers</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('flash');">flash</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounce');">bounce</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('shake');">shake</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('tada');">tada</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('swing');">swing</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('wobble');">wobble</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('pulse');">pulse</a>
			
			<h3>Flippers (currently Webkit &amp; IE10 only)</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('flip');">flip</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('flipInX');">flipInX</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('flipOutX');">flipOutX</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('flipInY');">flipInY</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('flipOutY');">flipOutY</a>
			
			<h3>Fading entrances</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeIn');">fadeIn</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeInUp');">fadeInUp</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeInDown');">fadeInDown</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeInLeft');">fadeInLeft</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeInRight');">fadeInRight</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeInUpBig');">fadeInUpBig</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeInDownBig');">fadeInDownBig</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeInLeftBig');">fadeInLeftBig</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeInRightBig');">fadeInRightBig</a>
			
			<h3>Fading exits</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOut');">fadeOut</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOutUp');">fadeOutUp</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOutDown');">fadeOutDown</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOutLeft');">fadeOutLeft</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOutRight');">fadeOutRight</a>			
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOutUpBig');">fadeOutUpBig</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOutDownBig');">fadeOutDownBig</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOutLeftBig');">fadeOutLeftBig</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('fadeOutRightBig');">fadeOutRightBig</a>
			
			<h3>Bouncing entrances</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceIn');">bounceIn</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceInDown');">bounceInDown</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceInUp');">bounceInUp</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceInLeft');">bounceInLeft</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceInRight');">bounceInRight</a>
			
			<h3>Bouncing exits</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceOut');">bounceOut</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceOutDown');">bounceOutDown</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceOutUp');">bounceOutUp</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceOutLeft');">bounceOutLeft</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('bounceOutRight');">bounceOutRight</a>
			
			<h3>Rotating entrances</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateIn');">rotateIn</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateInDownLeft');">rotateInDownLeft</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateInDownRight');">rotateInDownRight</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateInUpLeft');">rotateInUpLeft</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateInUpRight');">rotateInUpRight</a>
			
			<h3>Rotating exits</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateOut');">rotateOut</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateOutDownLeft');">rotateOutDownLeft</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateOutDownRight');">rotateOutDownRight</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateOutUpLeft');">rotateOutUpLeft</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rotateOutUpRight');">rotateOutUpRight</a>
			
			<h3>Specials</h3>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('hinge');">hinge</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rollIn');">rollIn</a>
			<a class="butt butt-small" href="#cta" onclick="$('#animateTest').removeClass().addClass('rollOut');">rollOut</a>
			
			<hr>

</body>
</html>
